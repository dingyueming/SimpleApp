
@{
    ViewData["Title"] = ViewData["Title"] ?? "实时监控";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Version"] = "20200518";
}
@section style{
    <!--ztree-->
    <link rel="stylesheet" href="~/lib/ztree/css/zTreeStyle/zTreeStyle.css" type="text/css">
}

@section script{
    <!--引入高德地图JSAPI -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key=07daf7aebe56f6b49516fa87628a06e4"></script>
    <!--引入UI组件库（1.1版本） -->
    <script src="//webapi.amap.com/ui/1.1/main.js"></script>
    <!--引入本地地图工具 -->
    <script src="~/plugins/amap/js/mapTools.js"></script>
    <!--ztree-->
    <script type="text/javascript" src="~/lib/ztree/js/jquery.ztree.core.js"></script>
    <script type="text/javascript" src="~/lib/ztree/js/jquery.ztree.exhide.js"></script>
    <script type="text/javascript" src="~/lib/ztree/js/jquery.ztree.excheck.js"></script>
    <script type="text/javascript" src="~/lib/ztree/js/jquery.ztree.exedit.js"></script>
    <script type="text/javascript" src="~/lib/ztree/demo/js/fuzzysearch.js"></script>
}
<div id="vmContent">
    <div class="row">
        <div class="col-md-2" v-show="!isFullScreen" style="padding:0px 0px 0px 5px;">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <h4 class="box-title">设备列表</h4>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="box-body  no-padding">
                    <div class="pad">
                        <input type="text" id="key" value="" style="width:100%;" class="empty" placeholder="请输入关键字" /><br />
                        <ul id="treeDemo" class="ztree" style="border:0px; height:427px;width:100%; margin-top:3px; overflow:auto;"></ul>
                    </div>
                </div>
            </div>
        </div>
        <div :class="!isFullScreen?fullScreenStyle.colmd10:fullScreenStyle.colmd12" style="padding:0px 5px 0px 5px;">
            <div class="box box-success">
                <div class="box-header with-border">
                    <h4 class="box-title">实时地图</h4>
                    <div class="box-tools pull-right">
                        <button class="btn" v-on:click="isFullScreen=!isFullScreen">{{!isFullScreen?"全屏":"退出全屏"}}</button>
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="box-body no-padding">
                    <div class="pad">
                        <!-- Map will be created here -->
                        <!-- 提供地图容器，其中地图容器必须提供id号，用于生成地图 -->
                        <div id="container" :style="{height:(isFullScreen?fullScreenStyle.fullHeight+'px':fullScreenStyle.normalHeight+'px')}"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row" v-show="!isFullScreen">
        <div class="col-md-12" style="margin-top:-15px;padding:0px 5px 0px 5px;">
            <div class="nav-tabs-custom" style="margin-bottom:0px;">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab_1" data-toggle="tab">定位信息</a></li>
                    <li><a href="#tab_2" data-toggle="tab">报警信息</a></li>
                    <li><a href="#tab_3" data-toggle="tab">短报文</a></li>
                    <li class="pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            @*<i class="fa fa-minus"></i>*@
                        </button>
                    </li>
                </ul>
                <div class="tab-content" style="overflow:auto; height:245px;">
                    <div class="tab-pane active" id="tab_1">
                        <table class="table table-hover">
                            <tr>
                                @*<th>序号</th>*@
                                <th>车牌号</th>
                                <th>识别码</th>
                                <th>SIM卡</th>
                                <th>定位时间</th>
                                <th>接收时间</th>
                                <th>速度</th>
                                <th>定位</th>
                                <th>方向</th>
                                <th>状态</th>
                                <th>定位模式</th>
                                <th>累计里程</th>
                                @*<th>位置</th>*@
                                <th>经度</th>
                                <th>纬度</th>
                            </tr>
                            <tr v-for="(newtrack,index) in gpsDatas" v-on:dblclick="dbclickLocationTable(newtrack.mac)">
                                <td>{{newtrack.license}}</td>
                                <td>{{newtrack.mac}}</td>
                                <td>{{newtrack.sim}}</td>
                                <td>{{newtrack.gnsstime}}</td>
                                <td>{{newtrack.receive_time}}</td>
                                <td>{{newtrack.speed}}</td>
                                <td>{{newtrack.locate_str}}</td>
                                <td>{{newtrack.heading_str}}</td>
                                <td>{{newtrack.status}}</td>
                                <td>{{newtrack.locatemode_str}}</td>
                                <td>{{newtrack.mileage}}</td>
                                <td>{{newtrack.longitude}}</td>
                                <td>{{newtrack.latitude}}</td>
                            </tr>
                        </table>
                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane" id="tab_2">
                        <table class="table table-hover">
                            <tr>
                                <th>车牌号</th>
                                <th>识别码</th>
                                <th>SIM卡</th>
                                <th>报警时间</th>
                                <th>报警信息</th>
                                <th>速度</th>
                                <th>方向</th>
                                <th>定位状态</th>
                                <th>定位</th>
                                <th>定位模式</th>
                            </tr>
                            <tr v-for="(alarmData,index) in alarmDatas" v-on:dblclick="dbclickLocationTable(alarmData.mac)">
                                <td>{{alarmData.license}}</td>
                                <td>{{alarmData.mac}}</td>
                                <td>{{alarmData.sim}}</td>
                                <td>{{alarmData.gnsstime}}</td>
                                <td>{{alarmData.alarmtype}}</td>
                                <td>{{alarmData.speed}}</td>
                                <td>{{alarmData.heading_str}}</td>
                                <td>{{alarmData.status}}</td>
                                <td>{{alarmData.locate_str}}</td>
                                <td>{{alarmData.locatemode_str}}</td>
                            </tr>
                        </table>
                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane" id="tab_3">
                        <table class="table table-condensed">
                            <tr>
                                <th>序号</th>
                                <th>内容</th>
                                <th>时间</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Controllers/AMap/RealTimeMapController.js?r=@Guid.NewGuid()"></script>